{"ast":null,"code":"import _toConsumableArray from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/workspace/upload-download-file/react-multiple-files-upload/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import UploadService from\"../services/upload-files.service\";var UploadFiles=/*#__PURE__*/function(_Component){_inherits(UploadFiles,_Component);var _super=_createSuper(UploadFiles);function UploadFiles(props){var _this;_classCallCheck(this,UploadFiles);_this=_super.call(this,props);_this.selectFiles=_this.selectFiles.bind(_assertThisInitialized(_this));_this.upload=_this.upload.bind(_assertThisInitialized(_this));_this.uploadFiles=_this.uploadFiles.bind(_assertThisInitialized(_this));_this.state={selectedFiles:undefined,progressInfos:[],message:[],fileInfos:[]};return _this;}_createClass(UploadFiles,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;UploadService.getFiles().then(function(response){_this2.setState({fileInfos:response.data});});}},{key:\"selectFiles\",value:function selectFiles(event){this.setState({progressInfos:[],selectedFiles:event.target.files});}},{key:\"upload\",value:function upload(idx,file){var _this3=this;var _progressInfos=_toConsumableArray(this.state.progressInfos);UploadService.upload(file,function(event){_progressInfos[idx].percentage=Math.round(100*event.loaded/event.total);_this3.setState({_progressInfos:_progressInfos});}).then(function(response){_this3.setState(function(prev){var nextMessage=[].concat(_toConsumableArray(prev.message),[\"Uploaded the file successfully: \"+file.name]);return{message:nextMessage};});return UploadService.getFiles();}).then(function(files){_this3.setState({fileInfos:files.data});}).catch(function(){_progressInfos[idx].percentage=0;_this3.setState(function(prev){var nextMessage=[].concat(_toConsumableArray(prev.message),[\"Could not upload the file: \"+file.name]);return{progressInfos:_progressInfos,message:nextMessage};});});}},{key:\"uploadFiles\",value:function uploadFiles(){var _this4=this;var selectedFiles=this.state.selectedFiles;var _progressInfos=[];for(var i=0;i<selectedFiles.length;i++){_progressInfos.push({percentage:0,fileName:selectedFiles[i].name});}this.setState({progressInfos:_progressInfos,message:[]},function(){for(var _i=0;_i<selectedFiles.length;_i++){_this4.upload(_i,selectedFiles[_i]);}});}},{key:\"render\",value:function render(){var _this$state=this.state,selectedFiles=_this$state.selectedFiles,progressInfos=_this$state.progressInfos,message=_this$state.message,fileInfos=_this$state.fileInfos;return/*#__PURE__*/React.createElement(\"div\",null,progressInfos&&progressInfos.map(function(progressInfo,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"mb-2\",key:index},/*#__PURE__*/React.createElement(\"span\",null,progressInfo.fileName),/*#__PURE__*/React.createElement(\"div\",{className:\"progress\"},/*#__PURE__*/React.createElement(\"div\",{className:\"progress-bar progress-bar-info\",role:\"progressbar\",\"aria-valuenow\":progressInfo.percentage,\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\",style:{width:progressInfo.percentage+\"%\"}},progressInfo.percentage,\"%\")));}),/*#__PURE__*/React.createElement(\"div\",{className:\"row my-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\"},/*#__PURE__*/React.createElement(\"label\",{className:\"btn btn-default p-0\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",multiple:true,onChange:this.selectFiles}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success btn-sm\",disabled:!selectedFiles,onClick:this.uploadFiles},\"Upload\"))),message.length>0&&/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-secondary\",role:\"alert\"},/*#__PURE__*/React.createElement(\"ul\",null,message.map(function(item,i){return/*#__PURE__*/React.createElement(\"li\",{key:i},item);}))),/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header\"},\"List of Files\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group list-group-flush\"},fileInfos&&fileInfos.map(function(file,index){return/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\",key:index},/*#__PURE__*/React.createElement(\"a\",{href:'/api/files/'+file.name},file.name));}))));}}]);return UploadFiles;}(Component);export{UploadFiles as default};","map":{"version":3,"sources":["/workspace/upload-download-file/react-multiple-files-upload/src/components/upload-files.component.js"],"names":["React","Component","UploadService","UploadFiles","props","selectFiles","bind","upload","uploadFiles","state","selectedFiles","undefined","progressInfos","message","fileInfos","getFiles","then","response","setState","data","event","target","files","idx","file","_progressInfos","percentage","Math","round","loaded","total","prev","nextMessage","name","catch","i","length","push","fileName","map","progressInfo","index","width","item"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport UploadService from \"../services/upload-files.service\";\n\nexport default class UploadFiles extends Component {\n  constructor(props) {\n    super(props);\n    this.selectFiles = this.selectFiles.bind(this);\n    this.upload = this.upload.bind(this);\n    this.uploadFiles = this.uploadFiles.bind(this);\n\n    this.state = {\n      selectedFiles: undefined,\n      progressInfos: [],\n      message: [],\n\n      fileInfos: [],\n    };\n  }\n\n  componentDidMount() {\n    UploadService.getFiles().then((response) => {\n      this.setState({\n        fileInfos: response.data,\n      });\n    });\n  }\n\n  selectFiles(event) {\n    this.setState({\n      progressInfos: [],\n      selectedFiles: event.target.files,\n    });\n  }\n\n  upload(idx, file) {\n    let _progressInfos = [...this.state.progressInfos];\n\n    UploadService.upload(file, (event) => {\n      _progressInfos[idx].percentage = Math.round((100 * event.loaded) / event.total);\n      this.setState({\n        _progressInfos,\n      });\n    })\n      .then((response) => {\n        this.setState((prev) => {\n          let nextMessage = [...prev.message, \"Uploaded the file successfully: \" + file.name];\n          return {\n            message: nextMessage\n          };\n        });\n\n        return UploadService.getFiles();\n      })\n      .then((files) => {\n        this.setState({\n          fileInfos: files.data,\n        });\n      })\n      .catch(() => {\n        _progressInfos[idx].percentage = 0;\n        this.setState((prev) => {\n          let nextMessage = [...prev.message, \"Could not upload the file: \" + file.name];\n          return {\n            progressInfos: _progressInfos,\n            message: nextMessage\n          };\n        });\n      });\n  }\n\n  uploadFiles() {\n    const selectedFiles = this.state.selectedFiles;\n\n    let _progressInfos = [];\n\n    for (let i = 0; i < selectedFiles.length; i++) {\n      _progressInfos.push({ percentage: 0, fileName: selectedFiles[i].name });\n    }\n\n    this.setState(\n      {\n        progressInfos: _progressInfos,\n        message: [],\n      },\n      () => {\n        for (let i = 0; i < selectedFiles.length; i++) {\n          this.upload(i, selectedFiles[i]);\n        }\n      }\n    );\n  }\n\n  render() {\n    const { selectedFiles, progressInfos, message, fileInfos } = this.state;\n\n    return (\n      <div>\n        {progressInfos &&\n          progressInfos.map((progressInfo, index) => (\n            <div className=\"mb-2\" key={index}>\n              <span>{progressInfo.fileName}</span>\n              <div className=\"progress\">\n                <div\n                  className=\"progress-bar progress-bar-info\"\n                  role=\"progressbar\"\n                  aria-valuenow={progressInfo.percentage}\n                  aria-valuemin=\"0\"\n                  aria-valuemax=\"100\"\n                  style={{ width: progressInfo.percentage + \"%\" }}\n                >\n                  {progressInfo.percentage}%\n                </div>\n              </div>\n            </div>\n          ))}\n\n        <div className=\"row my-3\">\n          <div className=\"col-8\">\n            <label className=\"btn btn-default p-0\">\n              <input type=\"file\" multiple onChange={this.selectFiles} />\n            </label>\n          </div>\n\n          <div className=\"col-4\">\n            <button\n              className=\"btn btn-success btn-sm\"\n              disabled={!selectedFiles}\n              onClick={this.uploadFiles}\n            >\n              Upload\n            </button>\n          </div>\n        </div>\n\n        {message.length > 0 && (\n          <div className=\"alert alert-secondary\" role=\"alert\">\n            <ul>\n              {message.map((item, i) => {\n                return <li key={i}>{item}</li>;\n              })}\n            </ul>\n          </div>\n        )}\n\n        <div className=\"card\">\n          <div className=\"card-header\">List of Files</div>\n          <ul className=\"list-group list-group-flush\">\n            {fileInfos &&\n              fileInfos.map((file, index) => (\n                <li className=\"list-group-item\" key={index}>\n                  <a href={'/api/files/' + file.name}>{file.name}</a>\n                </li>\n              ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}